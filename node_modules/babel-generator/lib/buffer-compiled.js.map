{"version":3,"sources":["buffer.js"],"names":[],"mappings":"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","file":"buffer-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _trimEnd = require(\"lodash/trimEnd\");\n\nvar _trimEnd2 = _interopRequireDefault(_trimEnd);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar SPACES_RE = /^[ \\t]+$/;\n\nvar Buffer = function () {\n  function Buffer(map) {\n    (0, _classCallCheck3.default)(this, Buffer);\n    this._map = null;\n    this._buf = [];\n    this._last = \"\";\n    this._queue = [];\n    this._position = {\n      line: 1,\n      column: 0\n    };\n    this._sourcePosition = {\n      identifierName: null,\n      line: null,\n      column: null,\n      filename: null\n    };\n\n    this._map = map;\n  }\n\n  Buffer.prototype.get = function get() {\n    this._flush();\n\n    return {\n      code: (0, _trimEnd2.default)(this._buf.join(\"\")),\n      map: this._map ? this._map.get() : null\n    };\n  };\n\n  Buffer.prototype.append = function append(str) {\n    this._flush();\n    var _sourcePosition = this._sourcePosition,\n        line = _sourcePosition.line,\n        column = _sourcePosition.column,\n        filename = _sourcePosition.filename,\n        identifierName = _sourcePosition.identifierName;\n\n    this._append(str, line, column, identifierName, filename);\n  };\n\n  Buffer.prototype.queue = function queue(str) {\n    if (str === \"\\n\") while (this._queue.length > 0 && SPACES_RE.test(this._queue[0][0])) {\n      this._queue.shift();\n    }var _sourcePosition2 = this._sourcePosition,\n        line = _sourcePosition2.line,\n        column = _sourcePosition2.column,\n        filename = _sourcePosition2.filename,\n        identifierName = _sourcePosition2.identifierName;\n\n    this._queue.unshift([str, line, column, identifierName, filename]);\n  };\n\n  Buffer.prototype._flush = function _flush() {\n    var item = void 0;\n    while (item = this._queue.pop()) {\n      this._append.apply(this, item);\n    }\n  };\n\n  Buffer.prototype._append = function _append(str, line, column, identifierName, filename) {\n    if (this._map && str[0] !== \"\\n\") {\n      this._map.mark(this._position.line, this._position.column, line, column, identifierName, filename);\n    }\n\n    this._buf.push(str);\n    this._last = str[str.length - 1];\n\n    for (var i = 0; i < str.length; i++) {\n      if (str[i] === \"\\n\") {\n        this._position.line++;\n        this._position.column = 0;\n      } else {\n        this._position.column++;\n      }\n    }\n  };\n\n  Buffer.prototype.removeTrailingNewline = function removeTrailingNewline() {\n    if (this._queue.length > 0 && this._queue[0][0] === \"\\n\") this._queue.shift();\n  };\n\n  Buffer.prototype.removeLastSemicolon = function removeLastSemicolon() {\n    if (this._queue.length > 0 && this._queue[0][0] === \";\") this._queue.shift();\n  };\n\n  Buffer.prototype.endsWith = function endsWith(suffix) {\n    if (suffix.length === 1) {\n      var last = void 0;\n      if (this._queue.length > 0) {\n        var str = this._queue[0][0];\n        last = str[str.length - 1];\n      } else {\n        last = this._last;\n      }\n\n      return last === suffix;\n    }\n\n    var end = this._last + this._queue.reduce(function (acc, item) {\n      return item[0] + acc;\n    }, \"\");\n    if (suffix.length <= end.length) {\n      return end.slice(-suffix.length) === suffix;\n    }\n\n    return false;\n  };\n\n  Buffer.prototype.hasContent = function hasContent() {\n    return this._queue.length > 0 || !!this._last;\n  };\n\n  Buffer.prototype.source = function source(prop, loc) {\n    if (prop && !loc) return;\n\n    var pos = loc ? loc[prop] : null;\n\n    this._sourcePosition.identifierName = loc && loc.identifierName || null;\n    this._sourcePosition.line = pos ? pos.line : null;\n    this._sourcePosition.column = pos ? pos.column : null;\n    this._sourcePosition.filename = loc && loc.filename || null;\n  };\n\n  Buffer.prototype.withSource = function withSource(prop, loc, cb) {\n    if (!this._map) return cb();\n\n    var originalLine = this._sourcePosition.line;\n    var originalColumn = this._sourcePosition.column;\n    var originalFilename = this._sourcePosition.filename;\n    var originalIdentifierName = this._sourcePosition.identifierName;\n\n    this.source(prop, loc);\n\n    cb();\n\n    this._sourcePosition.line = originalLine;\n    this._sourcePosition.column = originalColumn;\n    this._sourcePosition.filename = originalFilename;\n    this._sourcePosition.identifierName = originalIdentifierName;\n  };\n\n  Buffer.prototype.getCurrentColumn = function getCurrentColumn() {\n    var extra = this._queue.reduce(function (acc, item) {\n      return item[0] + acc;\n    }, \"\");\n    var lastIndex = extra.lastIndexOf(\"\\n\");\n\n    return lastIndex === -1 ? this._position.column + extra.length : extra.length - 1 - lastIndex;\n  };\n\n  Buffer.prototype.getCurrentLine = function getCurrentLine() {\n    var extra = this._queue.reduce(function (acc, item) {\n      return item[0] + acc;\n    }, \"\");\n\n    var count = 0;\n    for (var i = 0; i < extra.length; i++) {\n      if (extra[i] === \"\\n\") count++;\n    }\n\n    return this._position.line + count;\n  };\n\n  return Buffer;\n}();\n\nexports.default = Buffer;\nmodule.exports = exports[\"default\"];"]}