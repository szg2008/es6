{"version":3,"sources":["plugin.js"],"names":[],"mappings":"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","file":"plugin-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nvar _getIterator2 = require(\"babel-runtime/core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _optionManager = require(\"./file/options/option-manager\");\n\nvar _optionManager2 = _interopRequireDefault(_optionManager);\n\nvar _babelMessages = require(\"babel-messages\");\n\nvar messages = _interopRequireWildcard(_babelMessages);\n\nvar _store = require(\"../store\");\n\nvar _store2 = _interopRequireDefault(_store);\n\nvar _babelTraverse = require(\"babel-traverse\");\n\nvar _babelTraverse2 = _interopRequireDefault(_babelTraverse);\n\nvar _assign = require(\"lodash/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nvar _clone = require(\"lodash/clone\");\n\nvar _clone2 = _interopRequireDefault(_clone);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar GLOBAL_VISITOR_PROPS = [\"enter\", \"exit\"];\n\nvar Plugin = function (_Store) {\n  (0, _inherits3.default)(Plugin, _Store);\n\n  function Plugin(plugin, key) {\n    (0, _classCallCheck3.default)(this, Plugin);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, _Store.call(this));\n\n    _this.initialized = false;\n    _this.raw = (0, _assign2.default)({}, plugin);\n    _this.key = _this.take(\"name\") || key;\n\n    _this.manipulateOptions = _this.take(\"manipulateOptions\");\n    _this.post = _this.take(\"post\");\n    _this.pre = _this.take(\"pre\");\n    _this.visitor = _this.normaliseVisitor((0, _clone2.default)(_this.take(\"visitor\")) || {});\n    return _this;\n  }\n\n  Plugin.prototype.take = function take(key) {\n    var val = this.raw[key];\n    delete this.raw[key];\n    return val;\n  };\n\n  Plugin.prototype.chain = function chain(target, key) {\n    if (!target[key]) return this[key];\n    if (!this[key]) return target[key];\n\n    var fns = [target[key], this[key]];\n\n    return function () {\n      var val = void 0;\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      for (var _iterator = fns, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : (0, _getIterator3.default)(_iterator);;) {\n        var _ref;\n\n        if (_isArray) {\n          if (_i >= _iterator.length) break;\n          _ref = _iterator[_i++];\n        } else {\n          _i = _iterator.next();\n          if (_i.done) break;\n          _ref = _i.value;\n        }\n\n        var fn = _ref;\n\n        if (fn) {\n          var ret = fn.apply(this, args);\n          if (ret != null) val = ret;\n        }\n      }\n      return val;\n    };\n  };\n\n  Plugin.prototype.maybeInherit = function maybeInherit(loc) {\n    var inherits = this.take(\"inherits\");\n    if (!inherits) return;\n\n    inherits = _optionManager2.default.normalisePlugin(inherits, loc, \"inherits\");\n\n    this.manipulateOptions = this.chain(inherits, \"manipulateOptions\");\n    this.post = this.chain(inherits, \"post\");\n    this.pre = this.chain(inherits, \"pre\");\n    this.visitor = _babelTraverse2.default.visitors.merge([inherits.visitor, this.visitor]);\n  };\n\n  Plugin.prototype.init = function init(loc, i) {\n    if (this.initialized) return;\n    this.initialized = true;\n\n    this.maybeInherit(loc);\n\n    for (var key in this.raw) {\n      throw new Error(messages.get(\"pluginInvalidProperty\", loc, i, key));\n    }\n  };\n\n  Plugin.prototype.normaliseVisitor = function normaliseVisitor(visitor) {\n    for (var _iterator2 = GLOBAL_VISITOR_PROPS, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : (0, _getIterator3.default)(_iterator2);;) {\n      var _ref2;\n\n      if (_isArray2) {\n        if (_i2 >= _iterator2.length) break;\n        _ref2 = _iterator2[_i2++];\n      } else {\n        _i2 = _iterator2.next();\n        if (_i2.done) break;\n        _ref2 = _i2.value;\n      }\n\n      var key = _ref2;\n\n      if (visitor[key]) {\n        throw new Error(\"Plugins aren't allowed to specify catch-all enter/exit handlers. Please target individual nodes.\");\n      }\n    }\n\n    _babelTraverse2.default.explode(visitor);\n    return visitor;\n  };\n\n  return Plugin;\n}(_store2.default);\n\nexports.default = Plugin;\nmodule.exports = exports[\"default\"];"]}